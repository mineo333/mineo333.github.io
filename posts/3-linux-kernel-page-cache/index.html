<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Linux Kernel Page Cache" /><meta property="og:locale" content="en" /><meta name="description" content="One of QogChamp’s capabilities is performing “ghost file operations” or file operations that are easy to clean up and have little to no footprint. The page cache is the main structure used to pull this off." /><meta property="og:description" content="One of QogChamp’s capabilities is performing “ghost file operations” or file operations that are easy to clean up and have little to no footprint. The page cache is the main structure used to pull this off." /><link rel="canonical" href="https://mineo333.dev/posts/3-linux-kernel-page-cache/" /><meta property="og:url" content="https://mineo333.dev/posts/3-linux-kernel-page-cache/" /><meta property="og:site_name" content="mineo333/Sharad Khanna" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-08T15:40:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Linux Kernel Page Cache" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Linux Kernel Page Cache","dateModified":"2022-04-30T16:50:08+00:00","datePublished":"2021-11-08T15:40:00+00:00","description":"One of QogChamp’s capabilities is performing “ghost file operations” or file operations that are easy to clean up and have little to no footprint. The page cache is the main structure used to pull this off.","url":"https://mineo333.dev/posts/3-linux-kernel-page-cache/","mainEntityOfPage":{"@type":"WebPage","@id":"https://mineo333.dev/posts/3-linux-kernel-page-cache/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Linux Kernel Page Cache | mineo333/Sharad Khanna</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="mineo333/Sharad Khanna"><meta name="application-name" content="mineo333/Sharad Khanna"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/prof_pic.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">mineo333/Sharad Khanna</a></div><div class="site-subtitle font-italic">constantly in need of sleep</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mineo333" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sharad','mineo333.dev'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/khanna-sharad/" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://stackoverflow.com/users/8877217/sharad-khanna" aria-label="stack-overflow" class="order-6" target="_blank" rel="noopener"> <i class="fab fa-stack-overflow"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Linux Kernel Page Cache</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Linux Kernel Page Cache</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> mineo333/Sharad Khanna </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 8, 2021, 3:40 PM +0000" >Nov 8, 2021<i class="unloaded">2021-11-08T15:40:00+00:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Apr 30, 2022, 12:50 PM -0400" >Apr 30<i class="unloaded">2022-04-30T16:50:08+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1087 words">6 min read</span></div></div><div class="post-content"><p>One of QogChamp’s capabilities is performing “ghost file operations” or file operations that are easy to clean up and have little to no footprint. The page cache is the main structure used to pull this off.</p><h2 id="what-is-a-page-cache">What is a Page Cache?</h2><p>As you might know, block devices (Disks/SSDs) are EXTREMELY slow compared to RAM and CPU.</p><p>Now, this is a big problem, especially for read/write operations, as every time a program wants to read/write to/from a file, it needs to wait for the disk to complete the operation. This, due to the slow nature of the block devices, can burn CPU cycles and force programs to block for extended periods while waiting for the disk to complete. In the long run, this is bad and can greatly extend the runtime of certain programs that perform file operations (So basically, almost every program).</p><p>So, how do we solve this problem? As it turns out, the solution is surprisingly simple: make a copy of the file in memory. This makes file operations significantly faster as instead of constantly asking the disk, we simply perform our file operations (read, write, mmap, etc.) on memory which is much faster. We call this in-memory representation the <strong>page cache</strong>.</p><p>A common question that might follow from this is if we’re doing all our file operations on the page cache, how do changes get synced with the disk?</p><p>To sync changes, the Linux Kernel undergoes a process known as deferred write. With deferred write, the kernel waits until a good time to actually sync the changes with the disk. This is much faster than writing back immediately for one main reason: it allows us to do async IO.</p><p>Assuming that the user is not doing async IO, when a syscall like <code class="language-plaintext highlighter-rouge">write()</code> returns, the caller expects the buffer to be written to the disk. Therefore, if we are not using a page cache, we would have to wait for the write to the disk to complete, which can often be extremely slow. By using the page cache, we can give the user the illusion that the buffer was written to the disk via page cache (Which is much faster), and later, we can asynchronously write it back to the disk. Thus, we can return control more quickly to the user program in cases like <code class="language-plaintext highlighter-rouge">write()</code> without giving up any functionality, thus making the page cache a very fast and powerful method.</p><p>However, there are issues with the page cache. Because changes are written back to the disk later, those changes could be sitting in memory, unsynced for long periods. This can cause issues as if a computer crash occurs at an inopportune time, changes could be lost. Because of this, many programs like databases that cannot afford this loss of data use <code class="language-plaintext highlighter-rouge">sync()</code> frequently or use the <code class="language-plaintext highlighter-rouge">O_DIRECT</code> flag when writing, both of which start writeback immediately.</p><p>The nature of deferred write is immensely important for Qogchamp and is something that I will get into when discussing mmap.</p><h2 id="address_space">address_space</h2><p>As we discussed in the last post, the main structure used to handle the page cache is <code class="language-plaintext highlighter-rouge">struct address_space</code>. Yes this is an awful name as it has nothing to do with an address spaces (That is instead delegated to <code class="language-plaintext highlighter-rouge">vm_area_struct</code>), but it’s what we have.</p><p>Let’s go into more detail into what the structure contains.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span text-data=" C "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">struct</span> <span class="n">address_space</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">inode</span>		<span class="o">*</span><span class="n">host</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xarray</span>		<span class="n">i_pages</span><span class="p">;</span>
	<span class="n">gfp_t</span>			<span class="n">gfp_mask</span><span class="p">;</span>
	<span class="n">atomic_t</span>		<span class="n">i_mmap_writable</span><span class="p">;</span>
<span class="cp">#ifdef CONFIG_READ_ONLY_THP_FOR_FS
</span>	<span class="cm">/* number of thp, only for non-shmem files */</span>
	<span class="n">atomic_t</span>		<span class="n">nr_thps</span><span class="p">;</span>
<span class="cp">#endif
</span>	<span class="k">struct</span> <span class="n">rb_root_cached</span>	<span class="n">i_mmap</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rw_semaphore</span>	<span class="n">i_mmap_rwsem</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>		<span class="n">nrpages</span><span class="p">;</span>
	<span class="n">pgoff_t</span>			<span class="n">writeback_index</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">address_space_operations</span> <span class="o">*</span><span class="n">a_ops</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>		<span class="n">flags</span><span class="p">;</span>
	<span class="n">errseq_t</span>		<span class="n">wb_err</span><span class="p">;</span>
	<span class="n">spinlock_t</span>		<span class="n">private_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">private_list</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Above is the <code class="language-plaintext highlighter-rouge">struct address_space</code> from the 5.14 Linux Kernel. There are a few important fields.</p><p>The first field is <code class="language-plaintext highlighter-rouge">host</code>. <code class="language-plaintext highlighter-rouge">host</code> represents the inode that the page cache is mapping. This can be thought of as the file that the page cache is mapping into memory. I should note that <code class="language-plaintext highlighter-rouge">struct inode</code> also references the <code class="language-plaintext highlighter-rouge">struct address_space</code>.</p><p>The next field of importance is <code class="language-plaintext highlighter-rouge">i_pages</code>. <code class="language-plaintext highlighter-rouge">i_pages</code> is a special kind of array (Don’t ask me how. That’s beyond me) that contains pointers to <code class="language-plaintext highlighter-rouge">struct page</code>s. These <code class="language-plaintext highlighter-rouge">struct page</code>s are the descriptors for the pages that are the in-memory representation of the file. In other words, this is the meat of the page cache. By kmapping the <code class="language-plaintext highlighter-rouge">struct page</code> pointers from <code class="language-plaintext highlighter-rouge">i_pages</code>, you will get direct access to the in-memory representation of the file. This is critical to getting the exploit to work.</p><p>To traverse the <code class="language-plaintext highlighter-rouge">struct xarray</code>, there are a suite functions in <a href="https://elixir.bootlin.com/linux/latest/source/include/linux/xarray.h">xarray.h</a> that are available. These functions are used throughout the page cache code.</p><p>The third field of importance is <code class="language-plaintext highlighter-rouge">i_mmap</code>. <code class="language-plaintext highlighter-rouge">i_mmap</code> is a rb-interval tree which contains every <code class="language-plaintext highlighter-rouge">vm_area_struct</code> that maps this particular inode. For the Linux Kernel, this serves as the “rmap” or reverse mapping for file-backed mappings. In the Linux Kernel, every <code class="language-plaintext highlighter-rouge">struct page</code> has a pointer to every pte that maps that particular <code class="language-plaintext highlighter-rouge">struct page</code>. In other words, if given a <code class="language-plaintext highlighter-rouge">struct page</code>, I can find every pte that maps the contents of that <code class="language-plaintext highlighter-rouge">struct page</code> For anonymous pages, it is the <code class="language-plaintext highlighter-rouge">anon_vma</code> and for file-backed mappings it is <code class="language-plaintext highlighter-rouge">address_space -&gt; i_mmap</code>. We will see this field come up when we discuss mmap.</p><p>The last field that is important is <code class="language-plaintext highlighter-rouge">const struct address_space_operations *a_ops</code>. If you’re familiar with the Linux Kernel, this should be a familiar sight. This struct contains the “member functions” of the <code class="language-plaintext highlighter-rouge">address_space</code> object - yes, member functions in the same sense as Java. We will continually revisit this function as we discuss specific syscalls.</p><p>In order to better demonstrate how <code class="language-plaintext highlighter-rouge">struct address_space</code> works with other Linux Kernel data structures, I have placed a fantastic image below.</p><p><img data-proofer-ignore data-src="/assets/img/3/page_cache.jpeg" alt="Page Cache" /></p><p>In the picture, the <code class="language-plaintext highlighter-rouge">struct page</code> pointers are stored in <code class="language-plaintext highlighter-rouge">i_pages</code> and these <code class="language-plaintext highlighter-rouge">struct page</code>s are mapped into various VMAs throughout the system. These various VMAs also contain <code class="language-plaintext highlighter-rouge">struct file</code>s which then point back to the <code class="language-plaintext highlighter-rouge">struct address_space</code>.</p><h2 id="whats-next">What’s Next</h2><p>From here, I want to go into how exactly <code class="language-plaintext highlighter-rouge">read</code>, <code class="language-plaintext highlighter-rouge">write</code>, <code class="language-plaintext highlighter-rouge">mmap</code>, and <code class="language-plaintext highlighter-rouge">sync</code> work as the knowledge gained from deeply studying these three syscalls will be critical in understanding how exactly this exploit works.</p><h2 id="references">References</h2><p>Information on Page Cache - <a href="https://courses.cs.vt.edu/~cs5204/fall15-gback/">https://courses.cs.vt.edu/~cs5204/fall15-gback/</a></p><p>More Information on Page Cache - Understanding the Linux Kernel 3rd Edition by Daniel P. Bovet and Marco Cesati - Chapter 15</p><p><code class="language-plaintext highlighter-rouge">struct address_space</code> - <a href="https://elixir.bootlin.com/linux/latest/source/include/linux/fs.h#L459">https://elixir.bootlin.com/linux/latest/source/include/linux/fs.h#L459</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/qogchamp/'>QogChamp</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux-kernel-exploitation/" class="post-tag no-text-decoration" >Linux Kernel Exploitation</a> <a href="/tags/page-cache/" class="post-tag no-text-decoration" >Page Cache</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Linux Kernel Page Cache - mineo333/Sharad Khanna&url=https://mineo333.dev/posts/3-linux-kernel-page-cache/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Linux Kernel Page Cache - mineo333/Sharad Khanna&u=https://mineo333.dev/posts/3-linux-kernel-page-cache/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Linux Kernel Page Cache - mineo333/Sharad Khanna&url=https://mineo333.dev/posts/3-linux-kernel-page-cache/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/4-sync-and-writeback/">sync and Writeback</a><li><a href="/posts/1-beginnings/">Beginnings</a><li><a href="/posts/2-paging-in-the-linux-kernel/">Paging in the Linux Kernel</a><li><a href="/posts/3-linux-kernel-page-cache/">Linux Kernel Page Cache</a><li><a href="/posts/what-is-qogchamp/">What is QogChamp?</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux-kernel-exploitation/">Linux Kernel Exploitation</a> <a class="post-tag" href="/tags/syscall/">Syscall</a> <a class="post-tag" href="/tags/mm/">MM</a> <a class="post-tag" href="/tags/page-cache/">Page Cache</a> <a class="post-tag" href="/tags/paging/">Paging</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/what-is-qogchamp/"><div class="card-body"> <span class="timeago small" >Oct 26, 2021<i class="unloaded">2021-10-26T13:46:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>What is QogChamp?</h3><div class="text-muted small"><p> So, the primary reason I made this blog was to document and discuss the logic and code behind my rootkit: QogChamp. In this post, I want to answer the simple question: What is QogChamp? Through th...</p></div></div></a></div><div class="card"> <a href="/posts/1-beginnings/"><div class="card-body"> <span class="timeago small" >Oct 26, 2021<i class="unloaded">2021-10-26T16:30:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Beginnings</h3><div class="text-muted small"><p> In this post, I hope to tell you about how QogChamp started and what the original codebase looked like. This will be a fairly brief post and won’t get too much into the codebase as the functions us...</p></div></div></a></div><div class="card"> <a href="/posts/2-paging-in-the-linux-kernel/"><div class="card-body"> <span class="timeago small" >Oct 29, 2021<i class="unloaded">2021-10-29T12:30:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Paging in the Linux Kernel</h3><div class="text-muted small"><p> Before I begin discussing the internals of the QogChamp exploit, I first need to discuss how the Linux kernel handles paging. This article will assume familiarity with paging as a concept. Quick ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/2-paging-in-the-linux-kernel/" class="btn btn-outline-primary" prompt="Older"><p>Paging in the Linux Kernel</p></a> <a href="/posts/4-sync-and-writeback/" class="btn btn-outline-primary" prompt="Newer"><p>sync and Writeback</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="">mineo333/Sharad Khanna</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux-kernel-exploitation/">Linux Kernel Exploitation</a> <a class="post-tag" href="/tags/syscall/">Syscall</a> <a class="post-tag" href="/tags/mm/">MM</a> <a class="post-tag" href="/tags/page-cache/">Page Cache</a> <a class="post-tag" href="/tags/paging/">Paging</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
